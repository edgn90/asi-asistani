<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AkÄ±llÄ± AÅŸÄ± AsistanÄ±</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* === MODERN & ELEGANCE TASARIM (v42.0) === */
        :root {
            --primary: #2563eb;           
            --primary-soft: #dbeafe;      
            --secondary: #4f46e5;         
            
            --accent-warning: #f59e0b;    
            --accent-danger: #dc2626;     
            --accent-success: #10b981;    
            
            --bg-body: #f8fafc;           
            --bg-surface: #ffffff;        
            
            --text-primary: #1e293b;      
            --text-secondary: #64748b;    
            
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.08), 0 2px 4px -2px rgb(0 0 0 / 0.08);
            --shadow-lg: 0 20px 25px -5px rgb(0 0 0 / 0.08), 0 8px 10px -6px rgb(0 0 0 / 0.02);
            --shadow-primary: 0 10px 15px -3px rgba(37, 99, 235, 0.3);

            --radius-md: 12px;
            --radius-lg: 20px;            
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-primary);
            padding: 30px 20px;
            min-height: 100vh;
            line-height: 1.6;
            background-image: linear-gradient(to bottom right, #f1f5f9, #f8fafc);
        }

        .container {
            max-width: 720px;
            margin: 0 auto;
            background: var(--bg-surface);
            padding: 45px;
            border-radius: 24px;
            box-shadow: var(--shadow-lg);
            border: 1px solid rgba(255,255,255,0.5);
        }

        h1 { 
            text-align: center; 
            color: var(--primary);
            font-weight: 800; 
            letter-spacing: -0.025em; 
            margin-bottom: 8px; 
            font-size: 2.4rem;
        }
        
        .subtitle { 
            text-align: center; 
            color: var(--text-secondary); 
            font-size: 1.1rem; 
            margin-bottom: 40px; 
            font-weight: 500; 
        }

        .top-warning {
            background: #fff7ed; color: #c2410c; padding: 16px 20px; border-radius: var(--radius-md);
            border: 1px solid #ffedd5; margin-bottom: 35px; 
            text-align: center; font-weight: 600; font-size: 0.95rem;
            display: flex; align-items: center; justify-content: center; gap: 12px;
            box-shadow: var(--shadow-sm);
        }

        /* Modern Kart YapÄ±sÄ± */
        .form-section {
            margin-bottom: 28px; padding: 30px; border-radius: var(--radius-lg); 
            background-color: var(--bg-surface); 
            transition: all 0.3s ease;
            box-shadow: var(--shadow-sm);
            border: 1px solid #e2e8f0;
        }
        .form-section:hover { box-shadow: var(--shadow-md); border-color: var(--primary-soft); transform: translateY(-2px); }

        .bg-child { background: linear-gradient(to bottom right, #f0f9ff, #ffffff); border-color: #bae6fd; }
        .bg-adult { background: linear-gradient(to bottom right, #fdf4ff, #ffffff); border-color: #e8d5f5; }

        label.main-label { display: block; margin-bottom: 12px; font-weight: 600; color: var(--text-primary); font-size: 0.95rem; }
        h3 { font-weight: 700; margin-bottom: 20px; font-size: 1.25rem; display: flex; align-items: center; gap: 10px; color: var(--primary); }

        input[type="date"], select {
            width: 100%; padding: 16px 20px; border: 1px solid transparent; border-radius: var(--radius-md);
            font-size: 1rem; color: var(--text-primary); background-color: #f1f5f9; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); appearance: none; font-weight: 500;
        }
        input[type="date"]:focus, select:focus { 
            outline: none; background-color: #fff; border-color: var(--primary); 
            box-shadow: 0 0 0 4px var(--primary-soft);
        }

        #yasBilgisi {
            margin-top: 18px; padding: 16px; background-color: var(--primary-soft); border-radius: var(--radius-md);
            color: var(--primary); font-weight: 600; font-size: 0.95rem; 
            display: none; animation: fadeIn 0.5s ease; border: 1px solid rgba(37, 99, 235, 0.1);
        }

        .checkbox-grid { display: grid; grid-template-columns: 1fr; gap: 16px; }
        @media (min-width: 600px) { .checkbox-grid { grid-template-columns: 1fr 1fr; } }

        .checkbox-item {
            display: flex; align-items: center; padding: 18px 22px; background: #ffffff; 
            border: 1px solid #e2e8f0; border-radius: var(--radius-lg); cursor: pointer; 
            transition: all 0.25s ease; font-size: 0.95rem; color: var(--text-secondary); font-weight: 500;
            box-shadow: var(--shadow-sm);
        }
        .checkbox-item:hover { background-color: #f8fafc; border-color: #cbd5e1; transform: translateY(-1px); }
        .checkbox-item input { margin-right: 16px; accent-color: var(--primary); width: 20px; height: 20px; }
        .checkbox-item:has(input:checked) {
            border-color: var(--primary); background-color: #f5faff; color: var(--primary);
            font-weight: 600; box-shadow: var(--shadow-md);
        }

        button {
            width: 100%; padding: 22px; 
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white; border: none; border-radius: var(--radius-lg); font-size: 1.2rem; font-weight: 700;
            cursor: pointer; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); margin-top: 40px; 
            box-shadow: var(--shadow-primary); letter-spacing: 0.01em;
        }
        button:hover { transform: translateY(-3px); box-shadow: 0 15px 30px -5px rgba(79, 70, 229, 0.4); }
        button:active { transform: translateY(-1px); }

        #sonucAlani { margin-top: 60px; animation: slideUp 0.7s cubic-bezier(0.16, 1, 0.3, 1); display: none; }

        .result-card {
            background: white; padding: 28px; margin-bottom: 24px; border-radius: var(--radius-lg);
            border-left: 4px solid; box-shadow: var(--shadow-md); transition: all 0.3s ease; position: relative;
        }
        .result-card:hover { transform: translateY(-3px); box-shadow: var(--shadow-lg); }
        
        .result-card.alert { border-left-color: var(--primary); } 
        .result-card.warning { border-left-color: var(--accent-warning); } 
        .result-card.info { border-left-color: var(--secondary); }
        
        /* === YENÄ°: ÅEFFAF/SOLUK KART STÄ°LÄ° (Meningokok iÃ§in) === */
        .result-card.faint { 
            border-left-color: #cbd5e1; 
            background-color: rgba(255, 255, 255, 0.6);
            opacity: 0.75;
        }

        .card-header-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; gap: 15px; }
        .card-title { font-weight: 700; font-size: 1.15rem; color: var(--text-primary); flex: 1; line-height: 1.4; }
        
        .status-toggle {
            display: flex; align-items: center; font-size: 0.85rem; color: var(--text-secondary); cursor: pointer;
            background: #f1f5f9; padding: 10px 18px; border-radius: 999px; border: 1px solid transparent;
            transition: all 0.2s; white-space: nowrap; font-weight: 600;
        }
        .status-toggle:hover { background-color: #e2e8f0; }
        .status-toggle input { margin-right: 10px; width: 18px; height: 18px; accent-color: var(--accent-success); cursor: pointer; }

        .card-body { font-size: 1rem; color: #4b5563; white-space: pre-line; line-height: 1.7; padding-top: 12px; border-top: 1px solid #f1f5f9; margin-top: 12px; }

        .result-card.completed { 
            border-left-color: var(--accent-success) !important; background: #f0fdf4 !important; 
            opacity: 0.7; transform: scale(0.98); box-shadow: none; border: 1px solid #bbf7d0;
        }
        .result-card.completed .card-title { text-decoration: line-through; color: var(--accent-success); }
        .result-card.completed .status-toggle { background-color: #dcfce7; color: #166534; }

        /* === TIMELINE === */
        .catchup-timeline { position: relative; padding-left: 24px; margin-top: 20px; }
        .catchup-timeline::before {
            content: ''; position: absolute; left: 7px; top: 5px; bottom: 5px;
            width: 2px; background-color: #e2e8f0;
        }
        .catchup-step { position: relative; margin-bottom: 24px; padding-left: 20px; }
        .catchup-step:last-child { margin-bottom: 0; }
        .catchup-step::after {
            content: ''; position: absolute; left: 0; top: 8px;
            width: 16px; height: 16px; background-color: #fff; 
            border: 3px solid var(--primary); border-radius: 50%; box-shadow: var(--shadow-sm);
        }
        .catchup-header {
            color: var(--primary); font-weight: 700; font-size: 0.9rem;
            text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 8px;
        }
        .catchup-content {
            color: var(--text-primary); font-weight: 500; font-size: 1rem;
            background: #fff; padding: 14px 18px; border-radius: var(--radius-md);
            border: 1px solid #e2e8f0; display: block;
            box-shadow: var(--shadow-sm);
        }

        .hidden { display: none; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(40px); } to { opacity: 1; transform: translateY(0); } }
        .form-section:not(.hidden), #detayliRiskListesi:not(.hidden) { animation: fadeIn 0.6s cubic-bezier(0.16, 1, 0.3, 1); }

    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ’‰ AkÄ±llÄ± AÅŸÄ± AsistanÄ±</h1>
    <p class="subtitle">KiÅŸiselleÅŸtirilmiÅŸ AÅŸÄ± Ã–nerileri</p>

    <div class="top-warning">
        <span style="font-size: 1.5rem;">âš ï¸</span>
        <div>Bu Ã¶neriler bilgilendirme amaÃ§lÄ±dÄ±r. Nihai karar iÃ§in lÃ¼tfen hekiminize danÄ±ÅŸÄ±nÄ±z.</div>
    </div>

    <div class="form-section bg-light">
        <label class="main-label">DoÄŸum Tarihi:</label>
        <input type="date" id="dogumTarihi" onchange="yasKontrolu()">
        
        <div id="yasBilgisi"></div>

        <div style="margin-top: 30px;">
            <label class="main-label">Cinsiyet:</label>
            <select id="cinsiyet" onchange="yasKontrolu()">
                <option value="erkek">Erkek</option>
                <option value="kadin">KadÄ±n</option>
            </select>
        </div>
    </div>

    <div id="cocukBolumu" class="form-section bg-child hidden">
        <h3>ğŸ‘¶ Ã‡ocuk AÅŸÄ± Durumu</h3>
        <label class="main-label">Ã‡ocuÄŸun bugÃ¼ne kadarki aÅŸÄ±larÄ± ulusal takvime gÃ¶re yapÄ±ldÄ± mÄ±?</label>
        
        <div class="checkbox-grid">
            <label class="checkbox-item">
                <input type="radio" name="asiDurumu" value="tam" checked>
                <span>âœ… Evet (YaÅŸÄ±na gÃ¶re tam aÅŸÄ±lÄ±)</span>
            </label>
            <label class="checkbox-item">
                <input type="radio" name="asiDurumu" value="eksik">
                <span>âŒ HayÄ±r (AÅŸÄ±larÄ± eksik/yapÄ±lmadÄ±)</span>
            </label>
        </div>
        <p style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 15px; padding-left: 5px;">â„¹ï¸ "HayÄ±r" seÃ§erseniz telafi (hÄ±zlandÄ±rÄ±lmÄ±ÅŸ) takvim oluÅŸturulacaktÄ±r.</p>
    </div>

    <div id="gebelikBolumu" class="form-section bg-adult hidden">
        <label class="main-label">ğŸ¤° Gebelik Durumu:</label>
        <select id="gebelikDurumu">
            <option value="hayir">Gebe DeÄŸil</option>
            <option value="evet">Evet, Gebe</option>
        </select>
    </div>

    <div id="meslekBolumu" class="form-section bg-adult hidden">
        <label class="main-label">ğŸ‘¨â€âš•ï¸ Meslek / Risk Durumu:</label>
        <select id="meslekDurumu">
            <option value="diger">DiÄŸer / Riskli Meslek DeÄŸil</option>
            <option value="saglikci">âš•ï¸ SaÄŸlÄ±k Ã‡alÄ±ÅŸanÄ± / Stajyer</option>
        </select>
    </div>

    <div id="eriskinBolumu" class="form-section bg-adult hidden">
        <h3>ğŸ§‘ TÄ±bbi Risk FaktÃ¶rleri</h3>
        <label class="main-label">AÅŸaÄŸÄ±daki hastalÄ±klardan hangisi mevcut?</label>
        <div class="checkbox-grid" style="margin-bottom: 30px;">
             <label class="checkbox-item"><input type="radio" name="ana_risk_durumu" value="hayir" onchange="riskDurumuDegisti()" checked> <span>Herhangi bir hastalÄ±ÄŸÄ±m/risk durumum yok</span></label>
             <label class="checkbox-item"><input type="radio" name="ana_risk_durumu" value="evet" onchange="riskDurumuDegisti()"> <span>HastalÄ±ÄŸÄ±m/risk durumum var</span></label>
        </div>

        <div id="detayliRiskListesi" class="hidden">
            <div style="padding: 28px; background-color: #fff7ed; border-radius: var(--radius-md); border: 1px solid #ffedd5;">
                <label class="main-label" style="font-size: 0.95rem; color: var(--accent-warning); margin-bottom: 20px;">LÃ¼tfen durumu seÃ§iniz:</label>
                <div class="checkbox-grid">
                    <label class="checkbox-item"><input type="radio" name="r_hastalik" value="kronik_metabolik" checked> Kronik Kalp / AkciÄŸer / Diyabet (DM)</label>
                    <label class="checkbox-item"><input type="radio" name="r_hastalik" value="kronik_karaciger"> Kronik KaraciÄŸer HastalÄ±ÄŸÄ±</label>
                    <label class="checkbox-item"><input type="radio" name="r_hastalik" value="kronik_bobrek"> Kronik BÃ¶brek HastalÄ±ÄŸÄ±</label>
                    <label class="checkbox-item"><input type="radio" name="r_hastalik" value="immunsupresyon"> Ä°mmÃ¼nsÃ¼presyonu Olanlar</label>
                    <label class="checkbox-item"><input type="radio" name="r_hastalik" value="aspleni"> Aspleni (Dalak YokluÄŸu/Ä°ÅŸlevsizliÄŸi)</label>
                    <label class="checkbox-item"><input type="radio" name="r_hastalik" value="kompleman"> Kompleman YetmezliÄŸi</label>
                    <label class="checkbox-item"><input type="radio" name="r_hastalik" value="solid_organ"> Solid Organ Nakli AlÄ±cÄ±larÄ±</label>
                    <label class="checkbox-item"><input type="radio" name="r_hastalik" value="kok_hucre"> Hematopoetik KÃ¶k HÃ¼cre Nakli</label>
                    <label class="checkbox-item"><input type="radio" name="r_hastalik" value="hiv"> HIV / AIDS</label>
                    <label class="checkbox-item"><input type="radio" name="r_hastalik" value="pihtilasma"> PÄ±htÄ±laÅŸma BozukluÄŸu</label>
                    <label class="checkbox-item"><input type="radio" name="r_hastalik" value="bos_cochlear"> Kohlear Ä°mplant / BOS KaÃ§aÄŸÄ±</label>
                </div>
            </div>
        </div>
    </div>

    <button onclick="sorgula()">SonuÃ§larÄ± GÃ¶ster</button>

    <div id="sonucAlani">
        <h3 style="justify-content: center;">ğŸ“‹ Ã–nerilen AÅŸÄ± Takvimi</h3>
        <div id="liste"></div>
    </div>
</div>

<script>
    // === 1. HASSAS YAÅ HESAPLAMA MOTORU ===
    function hesaplaTamYas(dogumTarihi, bugun) {
        let yil = bugun.getFullYear() - dogumTarihi.getFullYear();
        let ay = bugun.getMonth() - dogumTarihi.getMonth();
        let gun = bugun.getDate() - dogumTarihi.getDate();

        if (gun < 0) {
            ay--;
            const oncekiAy = new Date(bugun.getFullYear(), bugun.getMonth(), 0).getDate();
            gun += oncekiAy;
        }

        if (ay < 0) {
            yil--;
            ay += 12;
        }
        const toplamAy = (yil * 12) + ay;
        return { yil, ay, gun, toplamAy };
    }

    // === 2. ARAYÃœZ VE KONTROLLER ===
    function riskDurumuDegisti() {
        const anaDurum = document.querySelector('input[name="ana_risk_durumu"]:checked').value;
        const detayListesi = document.getElementById('detayliRiskListesi');
        if (anaDurum === 'evet') { detayListesi.classList.remove('hidden'); } else { detayListesi.classList.add('hidden'); }
    }

    function yasKontrolu() {
        const dtInput = document.getElementById('dogumTarihi').value;
        const yasBilgisiDiv = document.getElementById('yasBilgisi');
        if (!dtInput) { yasBilgisiDiv.style.display = 'none'; return; }

        const dogumTarihi = new Date(dtInput);
        const bugun = new Date();
        
        if (dogumTarihi > bugun) {
            yasBilgisiDiv.style.display = 'block';
            yasBilgisiDiv.innerHTML = "âš ï¸ Ä°leri bir tarih seÃ§tiniz.";
            yasBilgisiDiv.style.backgroundColor = "#fef2f2";
            yasBilgisiDiv.style.borderColor = "#fee2e2";
            yasBilgisiDiv.style.color = "#dc2626";
            return;
        }

        const yas = hesaplaTamYas(dogumTarihi, bugun);
        yasBilgisiDiv.style.display = 'block';
        yasBilgisiDiv.style.backgroundColor = "";
        yasBilgisiDiv.style.borderColor = "";
        yasBilgisiDiv.style.color = "";

        let yasMetni = "ğŸ“… YaÅŸÄ±nÄ±z: ";
        if (yas.yil > 0) yasMetni += `${yas.yil} YÄ±l `;
        if (yas.ay > 0) yasMetni += `${yas.ay} Ay `;
        yasMetni += `${yas.gun} GÃ¼n`;
        if (yas.yil === 0 && yas.ay === 0 && yas.gun === 0) yasMetni = "ğŸ“… HoÅŸ geldin bebek! (BugÃ¼n doÄŸdu)";
        yasBilgisiDiv.innerHTML = yasMetni;
        
        const cinsiyet = document.getElementById('cinsiyet').value;
        const cocukDiv = document.getElementById('cocukBolumu');
        const eriskinDiv = document.getElementById('eriskinBolumu');
        const gebelikDiv = document.getElementById('gebelikBolumu');
        const meslekDiv = document.getElementById('meslekBolumu');

        if (yas.toplamAy < 216) {
            // EriÅŸkin bÃ¶lÃ¼mleri gizle
            eriskinDiv.classList.add('hidden'); 
            gebelikDiv.classList.add('hidden'); 
            meslekDiv.classList.add('hidden');

            // 4 Aydan kÃ¼Ã§Ã¼kse Ã‡ocuk SorularÄ±nÄ± da gizle
            if (yas.toplamAy < 4) {
                cocukDiv.classList.add('hidden');
                // Gizliyken "tam" aÅŸÄ± durumunu varsayÄ±lan yap (Telafi Ã§Ä±kmasÄ±n)
                const tamRadio = document.querySelector('input[name="asiDurumu"][value="tam"]');
                if(tamRadio) tamRadio.checked = true;
            } else {
                cocukDiv.classList.remove('hidden');
            }

        } else {
            cocukDiv.classList.add('hidden'); eriskinDiv.classList.remove('hidden');
            if (cinsiyet === 'kadin' && yas.yil >= 18 && yas.yil <= 49) { gebelikDiv.classList.remove('hidden'); } 
            else { gebelikDiv.classList.add('hidden'); document.getElementById('gebelikDurumu').value = "hayir"; }
            if (yas.yil >= 18 && yas.yil <= 65) { meslekDiv.classList.remove('hidden'); } 
            else { meslekDiv.classList.add('hidden'); document.getElementById('meslekDurumu').value = "diger"; }
        }
    }
    document.addEventListener('DOMContentLoaded', yasKontrolu);

    // === 3. KART DURUM DEÄÄ°ÅTÄ°RME ===
    function durumDegistir(cardId) {
        const card = document.getElementById(cardId);
        const checkbox = card.querySelector('input[type="checkbox"]');
        const labelText = card.querySelector('.status-text');
        
        if (checkbox.checked) {
            card.classList.add('completed');
            labelText.textContent = "âœ… TAMAMLANDI";
        } else {
            card.classList.remove('completed');
            labelText.textContent = "Bu aÅŸÄ±yÄ± oldum";
        }
    }

    // === 4. TIMELINE ADIMI OLUÅTURUCU ===
    function createStep(zaman, asilar) {
        return `
        <div class="catchup-step">
            <div class="catchup-header">${zaman}</div>
            <div class="catchup-content">${asilar}</div>
        </div>`;
    }

    // === 5. ANA HESAPLAMA ===
    const ulusalTakvim = {
        0:  ["Hepatit B (1. Doz)"], 
        1:  ["Hepatit B (2. Doz) - 1. AyÄ±n Sonunda"], 
        2:  ["BCG (Verem)", "KPA (1. Doz)", "6'lÄ± karma aÅŸÄ± (DaBT-Ä°PA-Hib-HepB) (1. Doz)"], 
        4:  ["KPA (2. Doz)", "6'lÄ± karma aÅŸÄ± (DaBT-Ä°PA-Hib-HepB) (2. Doz)"], 
        6:  ["KPA (3. Doz)", "6'lÄ± karma aÅŸÄ± (DaBT-Ä°PA-Hib-HepB) (3. Doz)", "OPA (Oral Polio)"], 
        9:  ["Ek Doz KKK (SalgÄ±n durumu varsa/Doktor kararÄ±)"], 
        12: ["KPA (PekiÅŸtirme)", "KKK (1. Doz)", "SuÃ§iÃ§eÄŸi"], 
        18: ["6'lÄ± karma aÅŸÄ± (DaBT-Ä°PA-Hib-HepB) (PekiÅŸtirme)", "Hep-A (1. Doz)", "OPA (PekiÅŸtirme)"], 
        24: ["Hep-A (2. Doz)"], 
        48: ["KKK (2. Doz)", "4'lÃ¼ Karma"], 
        156: ["Td (EriÅŸkin Tipi Tetanoz-Difteri) - 13 YaÅŸ HatÄ±rlatma Dozu"]
    };

    function sorgula() {
        const dtInput = document.getElementById('dogumTarihi').value;
        if (!dtInput) { alert("LÃ¼tfen doÄŸum tarihi giriniz."); return; }

        const dogumTarihi = new Date(dtInput);
        const bugun = new Date();
        const yas = hesaplaTamYas(dogumTarihi, bugun);

        let oneriler = [];

        // SENARYO 1: Ã‡OCUK TELAFÄ°
        if (yas.toplamAy < 216) {
            const durum = document.querySelector('input[name="asiDurumu"]:checked').value;
            
            if (durum === 'tam') {
                if (ulusalTakvim[yas.toplamAy]) { 
                    ulusalTakvim[yas.toplamAy].forEach(asi => { 
                        oneriler.push({baslik: asi, detay: "Bu ay (doldurulan ay) takvime gÃ¶re yapÄ±lmalÄ±dÄ±r.", tip: "alert"}); 
                    }); 
                } else {
                    oneriler.push({baslik: "Bu Ay Rutin AÅŸÄ± Yok", detay: "BebeÄŸiniz ÅŸu an " + yas.ay + ". ayÄ±nÄ± doldurmuÅŸtur. Bir sonraki aÅŸÄ± zamanÄ±nÄ± bekleyiniz.", tip: "info"});
                }
            } else {
                let plan = `<div class="catchup-timeline">`;
                if (yas.toplamAy >= 4 && yas.toplamAy <= 11) {
                    plan += createStep("Ä°lk KarÅŸÄ±laÅŸma", "DaBT-Ä°PA-Hib-HepB, KPA, Ã–nce PPD, 2 gÃ¼n sonra BCG");
                    plan += createStep("1 Ay Sonra", "DaBT-Ä°PA-Hib-HepB");
                    plan += createStep("2 Ay Sonra", "DaBT-Ä°PA-Hib-HepB, OPA, KPA");
                    plan += createStep("6 Ay Sonra", "DaBT-Ä°PA-Hib-HepB, OPA, KPA");
                    plan += createStep("Not", "Ek doz KKK (9.ay), KKK-SuÃ§iÃ§eÄŸi (12.ay), Hep-A (18.ay)");
                }
                else if (yas.toplamAy >= 12 && yas.toplamAy <= 14) {
                    plan += createStep("Ä°lk KarÅŸÄ±laÅŸma", "DaBT-Ä°PA-Hib-HepB, KPA, PPD");
                    plan += createStep("2 GÃ¼n Sonra", "KKK, SuÃ§iÃ§eÄŸi, gerekirse BCG");
                    plan += createStep("2 Ay Sonra", "DaBT-Ä°PA-Hib-HepB, OPA, KPA");
                    plan += createStep("6 Ay Sonra", "DaBT-Ä°PA, HepB, OPA, KPA");
                }
                else if (yas.toplamAy >= 15 && yas.toplamAy <= 17) {
                    plan += createStep("Ä°lk KarÅŸÄ±laÅŸma", "DaBT-Ä°PA-Hib-HepB, KPA, PPD");
                    plan += createStep("2 GÃ¼n Sonra", "KKK, SuÃ§iÃ§eÄŸi, gerekirse BCG");
                    plan += createStep("2 Ay Sonra", "DaBT-Ä°PA, HepB, OPA, KPA");
                    plan += createStep("6 Ay Sonra", "DaBT-Ä°PA, OPA, KPA");
                }
                else if (yas.toplamAy >= 18 && yas.toplamAy <= 23) {
                    plan += createStep("Ä°lk KarÅŸÄ±laÅŸma", "DaBT-Ä°PA-Hib-HepB, KPA, Hep-A, PPD");
                    plan += createStep("2 GÃ¼n Sonra", "KKK, SuÃ§iÃ§eÄŸi, gerekirse BCG");
                    plan += createStep("2 Ay Sonra", "DaBT-Ä°PA, HepB, OPA, KPA");
                    plan += createStep("6 Ay Sonra", "DaBT-Ä°PA, OPA, KPA, Hep-A");
                }
                else if (yas.toplamAy >= 24 && yas.toplamAy <= 47) {
                    plan += createStep("Ä°lk KarÅŸÄ±laÅŸma", "DaBT-Ä°PA-Hib-HepB, KPA, Hep-A, PPD");
                    plan += createStep("2 GÃ¼n Sonra", "KKK, SuÃ§iÃ§eÄŸi, gerekirse BCG");
                    plan += createStep("2 Ay Sonra", "DaBT-Ä°PA, HepB, OPA");
                    plan += createStep("6 Ay Sonra", "DaBT-Ä°PA, OPA, KPA, Hep-A");
                }
                else if (yas.toplamAy >= 48 && yas.toplamAy <= 59) {
                    plan += createStep("Ä°lk KarÅŸÄ±laÅŸma", "DaBT-Ä°PA-Hib-HepB, KPA, Hep-A, PPD");
                    plan += createStep("2 GÃ¼n Sonra", "KKK, SuÃ§iÃ§eÄŸi, gerekirse BCG");
                    plan += createStep("1 Ay Sonra", "DaBT-Ä°PA, OPA, Hep-B, KKK");
                    plan += createStep("6 Ay Sonra", "DaBT-Ä°PA, OPA, Hep-A, Hep-B");
                }
                else if (yas.toplamAy >= 60 && yas.toplamAy <= 71) {
                    plan += createStep("Ä°lk KarÅŸÄ±laÅŸma", "DaBT-Ä°PA, Hep-B, KPA, Hep-A, PPD");
                    plan += createStep("2 GÃ¼n Sonra", "KKK, SuÃ§iÃ§eÄŸi, gerekirse BCG");
                    plan += createStep("1 Ay Sonra", "DaBT-Ä°PA, OPA, Hep-B, KKK");
                    plan += createStep("6 Ay Sonra", "DaBT-Ä°PA, OPA, Hep-A, Hep-B");
                }
                else if (yas.toplamAy >= 72) {
                    plan += createStep("1. KarÅŸÄ±laÅŸma", "Tdab/Td, Ä°PA/OPA, Hep-B, Hep-A, KKK, SuÃ§iÃ§eÄŸi");
                    plan += createStep("2. KarÅŸÄ±laÅŸma (1 Ay Sonra)", "Tdab/Td, OPA/Ä°PA, Hep-B, KKK");
                    plan += createStep("Tamamlama (6 ay sonra)", "Tdab/Td, OPA/Ä°PA, Hep-B, Hep-A");
                }
                else {
                    plan += createStep("Bilgi", "4 aydan kÃ¼Ã§Ã¼k bebekler iÃ§in standart takvime uyulmalÄ±dÄ±r.");
                }
                plan += `</div>`;
                oneriler.push({baslik: "ğŸš¨ TELAFÄ° PLANI (AÅŸÄ±sÄ±z/Eksik)", detay: plan, tip: "alert"});
            }
        }
        // SENARYO 2: ERÄ°ÅKÄ°N
        else {
            const gebelikDurumu = document.getElementById('gebelikDurumu').value === 'evet';
            const saglikciDurumu = document.getElementById('meslekDurumu').value === 'saglikci';
            const anaRisk = document.querySelector('input[name="ana_risk_durumu"]:checked').value;
            let seciliHastalik = 'yok';
            if (anaRisk === 'evet') { seciliHastalik = document.querySelector('input[name="r_hastalik"]:checked').value; }

            if (gebelikDurumu) {
                oneriler.push({baslik: "Mevsimsel Ä°nfluenza (Grip)", detay: "GebeliÄŸin 2. veya 3. trimesterinde, her yÄ±l EYLÃœLâ€“MART dÃ¶neminde 1 doz Ã¶nerilir.", tip: "alert"});
                const tdapDetay = `<span class="step-header">A) Primer Serisi TAM OLANLAR (Her Gebelikte):</span>1 doz Tdap, tercihen 18â€“24. haftalarda (en geÃ§ 32. haftanÄ±n sonuna kadar).<span class="step-header">B) Primer Serisi EKSÄ°K OLANLAR:</span>1. doz Tdap 18â€“24. haftalarda. 2. doz Td 28â€“32. haftalarda.`;
                oneriler.push({baslik: "Tdap / Td (Tetanoz-BoÄŸmaca)", detay: tdapDetay, tip: "alert"});
            }

            if (saglikciDurumu) {
                oneriler.push({baslik: "Td (EriÅŸkin tip Tetanoz-Difteri) AÅŸÄ±sÄ±", detay: "Daha Ã¶nce aÅŸÄ±lanma durumu kayÄ±tlÄ± olmayan tÃ¼m saÄŸlÄ±k Ã§alÄ±ÅŸanlarÄ±nÄ±n 3 doz Td aÅŸÄ±sÄ± ile primer baÄŸÄ±ÅŸÄ±klamalarÄ±nÄ±n tamamlanmasÄ± gerekmektedir.\nPrimer serisi tamamlanan tÃ¼m saÄŸlÄ±k Ã§alÄ±ÅŸanlarÄ±na 10 yÄ±lda bir hatÄ±rlatma dozu yapÄ±lmalÄ±dÄ±r.", tip: "alert"});
                if (gebelikDurumu) { oneriler.push({baslik: "KKK (KÄ±zamÄ±k-KÄ±zamÄ±kÃ§Ä±k-Kabakulak) AÅŸÄ±sÄ±", detay: "âš ï¸ Gebelik nedeniyle ÅŸu an KONTRENDÄ°KEDÄ°R (YapÄ±lamaz).", tip: "warning"}); } 
                else { oneriler.push({baslik: "KKK (KÄ±zamÄ±k-KÄ±zamÄ±kÃ§Ä±k-Kabakulak) AÅŸÄ±sÄ±", detay: "HastalÄ±ÄŸÄ± geÃ§irmemiÅŸ veya baÄŸÄ±ÅŸÄ±klÄ±ÄŸÄ± olmayanlara en az 1 ay ara ile iki doz KKK aÅŸÄ±sÄ± Ã¶nerilir.", tip: "info"}); }
                oneriler.push({baslik: "Mevsimsel Ä°nfluenza (Grip) AÅŸÄ±sÄ±", detay: "Her yÄ±l 1 doz aÅŸÄ± uygulamasÄ± Ã¶nerilir.", tip: "info"});
                if (gebelikDurumu) { oneriler.push({baslik: "SuÃ§iÃ§eÄŸi AÅŸÄ±sÄ±", detay: "âš ï¸ Gebelik nedeniyle ÅŸu an KONTRENDÄ°KEDÄ°R.", tip: "warning"}); } 
                else { oneriler.push({baslik: "SuÃ§iÃ§eÄŸi AÅŸÄ±sÄ±", detay: "HastalÄ±ÄŸÄ± geÃ§irmemiÅŸ veya baÄŸÄ±ÅŸÄ±klÄ±ÄŸÄ± olmayanlara en az 1 ay ara ile iki doz aÅŸÄ± Ã¶nerilir.", tip: "info"}); }
                oneriler.push({baslik: "Hepatit B AÅŸÄ±sÄ±", detay: "SaÄŸlÄ±k Ã§alÄ±ÅŸanlarÄ± iÃ§in mesleki temas riskleri nedeniyle Ã¶nerilir.", tip: "alert"});
                oneriler.push({baslik: "Hepatit A AÅŸÄ±sÄ±", detay: "Riskli birimlerde Ã§alÄ±ÅŸan saÄŸlÄ±k personeli iÃ§in Ã¶nerilir.", tip: "info"});
                // GÃœNCELLEME: Åeffaf Meningokok Ã–nerisi
                oneriler.push({
                    baslik: "Meningokok AÅŸÄ±sÄ±", 
                    detay: "Sadece laboratuvarda meningokok ile karÅŸÄ±laÅŸma ihtimali bulunan personele Ã¶nerilir.", 
                    tip: "faint" // Åeffaf kart stili
                });
            }

            if (!gebelikDurumu && !saglikciDurumu && yas.yil >= 18) {
                oneriler.push({baslik: "EriÅŸkin Tip Tetanos-Difteri (Td)", detay: "Eksik ise 3 doz birincil baÄŸÄ±ÅŸÄ±klama, tam ise 10 yÄ±lda bir hatÄ±rlatma.", tip: "info"});
            }

            switch (seciliHastalik) {
                case 'kronik_metabolik': oneriler.push({baslik: "PnÃ¶mokok (ZatÃ¼rre) AÅŸÄ±larÄ±", detay: "â€¢ Konjuge PnÃ¶mokok AÅŸÄ±sÄ± (KPA13)\nâ€¢ Polisakkarit PnÃ¶mokok AÅŸÄ±sÄ± (PPA23)\nğŸ‘‰ AÅŸÄ±lar arasÄ±nda en az 1 YIL ara olmalÄ±dÄ±r.", tip: "alert"}); break;
                case 'kronik_karaciger': oneriler.push({baslik: "Kronik KaraciÄŸer HastalÄ±ÄŸÄ±", detay: "â€¢ Hepatit A\nâ€¢ Hepatit B\nâ€¢ Konjuge PnÃ¶mokok AÅŸÄ±sÄ± (KPA13)\nâ€¢ Polisakkarit PnÃ¶mokok AÅŸÄ±sÄ± (PPA23)\nğŸ‘‰ PnÃ¶mokok aÅŸÄ±larÄ± arasÄ±nda en az 1 YIL ara olmalÄ±dÄ±r.", tip: "alert"}); break;
                case 'kronik_bobrek': oneriler.push({baslik: "Kronik BÃ¶brek HastalÄ±ÄŸÄ±", detay: "â€¢ Hepatit B AÅŸÄ±sÄ±", tip: "alert"}); break;
                case 'immunsupresyon': oneriler.push({baslik: "Ä°mmÃ¼nsÃ¼presyonu Olanlar", detay: "â€¢ Konjuge PnÃ¶mokok AÅŸÄ±sÄ± (KPA13)\nâ€¢ Polisakkarit PnÃ¶mokok AÅŸÄ±sÄ± (PPA23)\nğŸ‘‰ AÅŸÄ±lar arasÄ±nda en az 8 HAFTA ara olmalÄ±dÄ±r.", tip: "alert"}); break;
                case 'aspleni': oneriler.push({baslik: "Aspleni (Dalak YokluÄŸu)", detay: "â€¢ Konjuge PnÃ¶mokok AÅŸÄ±sÄ± (KPA13)\nâ€¢ Polisakkarit PnÃ¶mokok AÅŸÄ±sÄ± (PPA23) (En az 8 hafta ara ile)\nâ€¢ Haemophilus influenzae tip B (Hib)\nâ€¢ Meningokok AÅŸÄ±sÄ±\nâ€¢ Ä°nfluenza (Grip) AÅŸÄ±sÄ±", tip: "alert"}); break;
                case 'kompleman': oneriler.push({baslik: "Kompleman YetmezliÄŸi", detay: "â€¢ Konjuge PnÃ¶mokok AÅŸÄ±sÄ± (KPA13)\nâ€¢ Polisakkarit PnÃ¶mokok AÅŸÄ±sÄ± (PPA23) (En az 8 hafta ara ile)\nâ€¢ Haemophilus influenzae tip B (Hib)", tip: "alert"}); break;
                case 'solid_organ': oneriler.push({baslik: "Solid Organ Nakli AlÄ±cÄ±larÄ±", detay: "â€¢ Hepatit A\nâ€¢ Hepatit B\nâ€¢ SuÃ§iÃ§eÄŸi", tip: "alert"}); break;
                case 'kok_hucre': oneriler.push({baslik: "Hematopoetik KÃ¶k HÃ¼cre Nakli", detay: "â€¢ Hepatit A\nâ€¢ Hepatit B\nâ€¢ KKK (KÄ±zamÄ±k-KÄ±zamÄ±kÃ§Ä±k-Kabakulak)\nâ€¢ Konjuge PnÃ¶mokok AÅŸÄ±sÄ± (KPA13)\nâ€¢ Polisakkarit PnÃ¶mokok AÅŸÄ±sÄ± (PPA23)\nâ€¢ Haemophilus influenzae tip B (Hib)\nâ€¢ SuÃ§iÃ§eÄŸi\nâ€¢ Ä°naktif Polio AÅŸÄ±sÄ±", tip: "alert"}); break;
                case 'hiv': oneriler.push({baslik: "HIV / AIDS", detay: "â€¢ Hepatit A\nâ€¢ Hepatit B\nâ€¢ KKK (KÄ±zamÄ±k-KÄ±zamÄ±kÃ§Ä±k-Kabakulak)\nâ€¢ Konjuge PnÃ¶mokok AÅŸÄ±sÄ± (KPA13)\nâ€¢ Polisakkarit PnÃ¶mokok AÅŸÄ±sÄ± (PPA23) (En az 8 hafta ara ile)\nâ€¢ Haemophilus influenzae tip B (Hib)\nğŸ‘‰ AÅŸÄ±lama takvimi CD4 sayÄ±sÄ±na gÃ¶re uzman tarafÄ±ndan deÄŸerlendirilmelidir.", tip: "alert"}); break;
                case 'pihtilasma': oneriler.push({baslik: "PÄ±htÄ±laÅŸma BozukluÄŸu", detay: "â€¢ Hepatit A AÅŸÄ±sÄ±", tip: "alert"}); break;
                case 'bos_cochlear': oneriler.push({baslik: "Kohlear Ä°mplant / BOS KaÃ§aÄŸÄ±", detay: "â€¢ Konjuge PnÃ¶mokok AÅŸÄ±sÄ± (KPA13)\nâ€¢ Polisakkarit PnÃ¶mokok AÅŸÄ±sÄ± (PPA23) (En az 8 hafta ara ile)\nâ€¢ Haemophilus influenzae tip B (Hib)", tip: "alert"}); break;
            }

            if (yas.yil >= 65) {
                const fluVar = ['aspleni'].includes(seciliHastalik);
                const pneuVar = ['kronik_metabolik', 'kronik_karaciger', 'immunsupresyon', 'aspleni', 'kompleman', 'kok_hucre', 'hiv', 'bos_cochlear'].includes(seciliHastalik);
                if (!fluVar) { oneriler.push({baslik: "Mevsimsel Ä°nfluenza (Grip)", detay: "65 yaÅŸ Ã¼stÃ¼ herkese yÄ±llÄ±k Ã¶nerilir.", tip: "info"}); }
                if (!pneuVar) { oneriler.push({baslik: "PnÃ¶mokok AÅŸÄ±sÄ±", detay: "65 yaÅŸ Ã¼stÃ¼ herkese (KPA13 + 1 yÄ±l sonra PPA23) Ã¶nerilir.", tip: "warning"}); }
            }
        }

        const liste = document.getElementById('liste');
        liste.innerHTML = "";
        
        if (oneriler.length === 0) {
            liste.innerHTML = "<div class='result-card info'>Tebrikler, mevcut risklerinize gÃ¶re ek bir aÅŸÄ± Ã¶nerisi bulunmamaktadÄ±r.</div>";
        } else {
            oneriler.forEach((item, index) => {
                const isTelafi = item.baslik.includes("TELAFÄ° PLANI");
                const checkboxHTML = isTelafi ? '' : `
                    <label class="status-toggle">
                        <input type="checkbox" onchange="durumDegistir('card-${index}')">
                        <span class="status-text">Bu aÅŸÄ±yÄ± oldum</span>
                    </label>`;

                liste.innerHTML += `
                <div class="result-card ${item.tip}" id="card-${index}">
                    <div class="card-header-row">
                        <span class="card-title">${item.baslik}</span>
                        ${checkboxHTML}
                    </div>
                    <span class="card-body">${item.detay}</span>
                </div>`;
            });
        }

        document.getElementById('sonucAlani').style.display = 'block';
    }
</script>

</body>
</html>
